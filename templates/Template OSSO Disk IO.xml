<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2019-12-06T12:15:03Z</date>
    <groups>
        <group>
            <name>TEMPLATES</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template OSSO Disk IO</template>
            <name>Template OSSO Disk IO</name>
            <groups>
                <group>
                    <name>TEMPLATES</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Filesystems</name>
                </application>
                <application>
                    <name>Performance</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Disk discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>diskio.discover_disks</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Disk:$1:IO:current</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.io.active[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>io</units>
                            <description>The only field that should go to zero. Incremented as requests are given to appropriate struct request_queue and decremented as they finish.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:IO:ms</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.io.ms[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>ms</units>
                            <description>This field increases so long as field 9 (diskio.dev.io.active) is nonzero.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:R:merged</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.read.merged[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>Ops/s</units>
                            <description>Reads and writes which are adjacent to each other may be merged for efficiency. Thus two 4K reads may become one 8K read before it is ultimately handed to the disk, and so it will be counted (and queued) as only one I/O.  This field lets you know how often this was done.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:R:ms</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.read.ms[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>ms</units>
                            <description>This is the total number of milliseconds spent by all reads (as measured from __make_request() to end_that_request_last()).</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:R:ops/s</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.read.ops[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <units>ops/s</units>
                            <description>This is the total number of reads completed successfully.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:R:B/s</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.read.sectors[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <units>B/sec</units>
                            <description>This is the total number of sectors read successfully.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>512</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:W:merged</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.write.merged[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>Ops/s</units>
                            <description>Reads and writes which are adjacent to each other may be merged for efficiency. Thus two 4K reads may become one 8K read before it is ultimately handed to the disk, and so it will be counted (and queued) as only one I/O.  This field lets you know how often this was done.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:W:ms</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.write.ms[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <status>DISABLED</status>
                            <units>ms</units>
                            <description>This is the total number of milliseconds spent by all writes (as measured from __make_request() to end_that_request_last()).</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:W:ops/s</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.write.ops[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <units>ops/s</units>
                            <description>This is the total number of writes completed successfully.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Disk:$1:W:B/s</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.dev.write.sectors[{#DEVICENAME}]</key>
                            <history>30d</history>
                            <units>B/sec</units>
                            <description>This is the total number of sectors written successfully.</description>
                            <applications>
                                <application>
                                    <name>Performance</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>512</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Disk {#DEVICENAME} - B/s</name>
                            <graph_items>
                                <graph_item>
                                    <color>00C800</color>
                                    <item>
                                        <host>Template OSSO Disk IO</host>
                                        <key>diskio.dev.read.sectors[{#DEVICENAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>C80000</color>
                                    <item>
                                        <host>Template OSSO Disk IO</host>
                                        <key>diskio.dev.write.sectors[{#DEVICENAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                        <graph_prototype>
                            <name>Disk {#DEVICENAME} - ops/s</name>
                            <graph_items>
                                <graph_item>
                                    <color>00C800</color>
                                    <item>
                                        <host>Template OSSO Disk IO</host>
                                        <key>diskio.dev.read.ops[{#DEVICENAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>C80000</color>
                                    <item>
                                        <host>Template OSSO Disk IO</host>
                                        <key>diskio.dev.write.ops[{#DEVICENAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
                <discovery_rule>
                    <name>Mount discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>diskio.discover_mounts</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#FSNAME}</macro>
                                <value>@Exclude filesystems for discovery</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1w</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Mount $1 is writable</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>diskio.mount.writable[{#FSNAME}]</key>
                            <delay>5m</delay>
                            <history>1w</history>
                            <trends>1w</trends>
                            <applications>
                                <application>
                                    <name>Filesystems</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>BOOL_TO_DECIMAL</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>({TRIGGER.VALUE}=0 and&#13;
 {diff(0)}&lt;&gt;0) or&#13;
({TRIGGER.VALUE}=1 and&#13;
 {last(0)}=0)</expression>
                                    <name>Mount {#FSNAME} changed rw state on {HOST.NAME}!</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
</zabbix_export>
